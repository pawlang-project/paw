import "std/prelude.paw";

// 1..=n çš„å’Œ
fn sum_to(n: Int) -> Int {
  let s: Int = 0;
  for (let i: Int = 1; i <= n; i = i + 1) {
    s = s + i;
  }
  return s;
}

// æ‰¾åˆ°æœ€å° i ä½¿ i*i >= th
fn first_i_sq_ge(th: Int) -> Int {
  let i: Int = 0;
  for (i = 0; i < 100; i = i + 1) {
    if ((i * i) >= th) { break; }
  }
  return i;
}

// 0..10ï¼ˆä¸å«ï¼‰ç´¯åŠ ï¼Œä½†è·³è¿‡ 5
fn sum_skip_five() -> Int {
  let s: Int = 0;
  for (let i: Int = 0; i < 10; i = i + 1) {
    if (i == 5) { continue; }
    s = s + i;
  }
  return s;
}

// ç”¨ while åšä¸ªâ€œé˜¶ä¹˜â€é£Žæ ¼å¾ªçŽ¯ï¼ˆç¤ºä¾‹ï¼‰
fn fact_while(n: Int) -> Int {
  let i: Int = 1;
  let acc: Int = 1;
  while (i <= n) {
    acc = acc + 0;         // å ä½ï¼Œæµ‹è¯•å¤šæ¡èµ‹å€¼
    acc = acc * i;
    i = i + 1;
  }
  return acc;
}

// if ä½œä¸ºè¡¨è¾¾å¼
fn if_expr_demo(b: Bool) -> Int {
  let x: Int = if (b) { 123 } else { 456 };
  return x;
}

// match æ•´æ•°
fn match_int(x: Int) -> Int {
  match (x) {
    0 => { 100 },
    1 => { 200 },
    _ => { 999 },
  }
}

// match å¸ƒå°”
fn match_bool(b: Bool) -> Int {
  match (b) {
    true  => { 1 },
    false => { 0 },
  }
}

// match é•¿æ•´åž‹å­—é¢é‡
fn match_long_one() -> Int {
  let big: Long = 3000000000;
  match (big) {
    3000000000 => { 1 },
    _ => { 0 },
  }
}

// Long åŠ æ³•
fn long_add_demo(a: Long, b: Long) -> Long {
  return a + b;
}

// Double è¿ç®—ä¸Žä¸€å…ƒè´Ÿå·
fn double_demo() -> Double {
  return -125.0 + 0.5;  // -124.5
}

// æ‰“å°å­—ç¬¦ï¼ˆå«æ¢è¡Œä¸Ž Unicodeï¼‰
fn char_demo() -> Int {
  println_char('A');
  println_char('\n');
  println_char('\u{263A}');   // â˜º
  return 0;
}

// æ‰“å°å­—ç¬¦ä¸²
fn string_demo() -> Int {
  println_str("Hello, Paw!");
  return 0;
}

fn main() -> Void {
  println_str("== basic/print ==");
  println_int(42);
  println_bool(true);
  println_double(3.14159);
  println_str("done");

  println_str("== for/sum_to ==");
  println_int(sum_to(9));

  println_str("== for/break ==");
  println_int(first_i_sq_ge(30));

  println_str("== for/continue ==");
  println_int(sum_skip_five());

  println_str("== while/fact ==");
  println_int(fact_while(5));

  println_str("== if/expr ==");
  println_int(if_expr_demo(true));
  println_int(if_expr_demo(false));

  println_str("== match/int ==");
  println_int(match_int(0));
  println_int(match_int(1));
  println_int(match_int(42));

  println_str("== match/bool ==");
  println_int(match_bool(true));
  println_int(match_bool(false));

  println_str("== long/op ==");
  let la: Long = 3000000000;
  let lb: Long = 2;
  let lc: Long = long_add_demo(la, lb);
  println_long(lc);
  println_int(match_long_one());

  println_str("== double/op ==");
  println_double(double_demo());

  println_str("== char ==");
  let _c0: Int = char_demo();

  println_str("== string ==");
  let _s0: Int = string_demo();

  println_str("== float/edge ==");
  println_double(-0.25);
  println_double(1200.0);
  println_double(-0.034);

  println_str("== cmp/chain ==");
  if ((1 <= 2) && (3 >= 2)) {
    println_str("ok");
  }

  println_str("== char/escape ==");
  println_char('\t');
  println_char('\u{1F600}'); // ðŸ˜€
}
