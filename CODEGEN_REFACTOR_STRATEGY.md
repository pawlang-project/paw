# CodeGen重构策略 - 实用方案

## 问题分析
- codegen.cpp: 3936行（过大）
- 完全拆分需要: 10+ 小时
- 风险: 可能引入Bug

## 实用方案

### 阶段1: Doxygen注释（优先）⭐⭐⭐⭐⭐
**目标**: 为所有公开函数添加Doxygen注释

**收益**:
- 提升代码可读性
- 生成API文档
- 便于维护

**工作量**: 1-2小时

### 阶段2: 适度拆分（推荐）⭐⭐⭐⭐
**目标**: 拆分为3个核心文件

```
src/codegen/
├── codegen.h              (保持)
├── codegen.cpp            (核心 - ~1500行)
├── codegen_expr.cpp       (表达式 - ~1200行) 🆕
├── codegen_type.cpp       (泛型 - ~1200行) 🆕
```

**收益**:
- 大幅降低单文件复杂度
- 功能清晰分离
- 编译并行化

**工作量**: 2-3小时

### 阶段3: 完全拆分（长期）⭐⭐⭐
**目标**: 拆分为6个文件（如原计划）

**工作量**: 5-8小时

## 决定

**立即执行**: 阶段1 + 阶段2
**未来计划**: 阶段3

